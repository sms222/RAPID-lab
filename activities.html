<!DOCTYPE html>
<html>
<head>
  <title>Activities & Projects - RAPID</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="site-header">
  <div class="brand">
    <img src="logo.png" alt="RAPID logo" class="logo">
    <div class="brand-text">
      <h1>Activities & Projects</h1>
      <p>Ongoing research and academic activities</p>
    </div>
  </div>

  <nav class="nav">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="people.html">People</a>
    <a href="research.html">Research</a>
    <a href="activities.html">Activities</a>
    <a href="publications.html">Publications</a>
    <a href="collaborate.html">Collaborate</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<section>
  <h2>Conference Presentations</h2>
  <p class="small">Chronological (old → new). Update by replacing <code>conferences.csv</code>.</p>

  <div class="table-wrap">
    <table id="confTable">
      <thead>
        <tr>
          <th style="width: 90px;">Year</th>
          <th style="width: 180px;">Presenter</th>
          <th style="width: 260px;">Conference</th>
          <th style="width: 190px;">Location</th>
          <th>Title</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="5" class="small">Loading…</td></tr>
      </tbody>
    </table>
  </div>
</section>

<footer>
  Centre for Quality Management of Medicines, Faculty of Pharmacy UKM
</footer>

<script>
async function loadCSV(path) {
  const res = await fetch(path, { cache: "no-store" });
  const text = await res.text();
  return text.trim().split(/\r?\n/).map(line => {
    // Simple CSV split that handles quoted commas
    const out = [];
    let cur = "", inQ = false;
    for (let i = 0; i < line.length; i++) {
      const ch = line[i];
      if (ch === '"' ) inQ = !inQ;
      else if (ch === ',' && !inQ) { out.push(cur); cur = ""; }
      else cur += ch;
    }
    out.push(cur);
    return out.map(s => s.replace(/^"|"$/g, "").trim());
  });
}

function badge(year) {
  return `<span class="badge">${year}</span>`;
}

(async () => {
  const rows = await loadCSV("conferences.csv");
  const header = rows[0];
  const data = rows.slice(1);

  // Ensure chronological old -> new
  data.sort((a,b) => Number(a[0]) - Number(b[0]));

  const tbody = document.querySelector("#confTable tbody");
  tbody.innerHTML = "";

  for (const r of data) {
    const [Year, Presenter, Conference, Location, Title] = r;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${badge(Year)}</td>
      <td>${Presenter}</td>
      <td>${Conference}</td>
      <td>${Location}</td>
      <td>${Title}</td>
    `;
    tbody.appendChild(tr);
  }
})();
</script>

</body>
</html>
